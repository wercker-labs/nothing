box: wercker/default
build:
  steps:
    - script:
        name: building
        code: echo "building ..."
    - script:
        name: FAIL
        code: |
          cd
          wget http://secure.gravatar.com/avatar/37936f9de593de18c525a8e2f5707834?s=140
          cp "37936f9de593de18c525a8e2f5707834?s=140" "$WERCKER_REPORT_DIR/$WERCKER_STEP_ID/image.jpg"
        
  failed-steps:
    - script:
        name: failed :(
        code: echo ":("
  passed-steps:
    - script:
        name: passed :)
        code: echo ":)"
    - script:
        name: image
        code: |
          cd
          wget http://secure.gravatar.com/avatar/37936f9de593de18c525a8e2f5707834?s=140
          cp "37936f9de593de18c525a8e2f5707834?s=140" "$WERCKER_REPORT_DIR/$WERCKER_STEP_ID/image.jpg"
    
  final-steps:
    # - script:
    #     name: nope
    #     code: echo nope
    # - script:
    #     name: FAIL
    #     code: failuh
    # - script:
    #     name: nope
    #     code: echo nope
    # - wouter/hipchat-notify:
    #     token: $HIPCHAT_TOKEN
    #     room_id: 152974
    #     from_name: wercker
    #     message: $WERCKER_APPLICATION_OWNER_NAME/$WERCKER_APPLICATION_NAME build by $WERCKER_STARTED_BY finished
    # - wouter/campfire-notify:
    #     token: $CAMPFIRE_TOKEN
    #     room_id: 463743
    #     subdomain: wercker
    #     message: $WERCKER_APPLICATION_OWNER_NAME/$WERCKER_APPLICATION_NAME build by $WERCKER_STARTED_BY finished
    # - wouter/email-notify:
    #     from: pleasemailus@wercker.com
    #     to: wouter@wercker.com
    #     subject: $WERCKER_APPLICATION_OWNER_NAME/$WERCKER_APPLICATION_NAME build by $WERCKER_STARTED_BY finished
    #     username: pleasemailus@wercker.com
    #     password: $EMAIL_PASSWORD
    #     host: smtp.gmail.com:587
    # - wouter/irc-notify:
    #     server: irc.freenode.net
    #     port: 6667
    #     message: $WERCKER_APPLICATION_OWNER_NAME/$WERCKER_APPLICATION_NAME build by $WERCKER_STARTED_BY finished
    #     nickname: werckertest
    #     channel: "#wercker"
deploy:
  steps:
    - script:
        name: deploy
        code: echo "deploying"
  passed-steps:
    - script:
        name: passed :)
        code: echo ":)"
    - script:
        name: post deploy warm up sleep
        code: sleep 60
    - script:
        name: post deploy run sleep
        code: sleep 60
    - wwwouter/graphite-check:
        pre-deploy-period: 300
        post-deploy-warm-up: 60
        url: $GRAPHITE_URL
        target: "*.*.*"
        diff-threshold: 0
    # - wouter/loggly-check:
    #     username: $LOGGLY_USERNAME
    #     password: $LOGGLY_PASSWORD
    #     subdomain: wercker
    #     query: json.level:debug
    #     from: NOW-10MINUTES
        
    # - script:
    #     name: image
    #     code: |
    #       cd
    #       wget http://secure.gravatar.com/avatar/37936f9de593de18c525a8e2f5707834?s=140
    #       cp "37936f9de593de18c525a8e2f5707834?s=140" "$WERCKER_REPORT_DIR/$WERCKER_STEP_ID/image.jpg"
    #       ohnooooeeesssss
